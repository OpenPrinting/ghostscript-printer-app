--- fxlinuxprint.c.orig	2021-10-19 09:40:20.246591165 +0200
+++ fxlinuxprint.c	2021-10-19 10:43:25.611115379 +0200
@@ -361,24 +361,19 @@
 int fxGetPrintOptions (int argc, const char* argv[], LPFX_OPTION_T opt)
 {
 	const char			*file_name;
-	int 				num_dests;
 	int 				i;
 	int 				j;
 	int					num_options;
 	int					myalloc;
 	cups_option_t		*p_options;
-	cups_dest_t			*dest;
-	cups_dest_t			*dests;
 	ppd_choice_t		*p_choice;
 	ppd_file_t			*p_ppd;
 	LPFX_PPD_OPT_CHOICE	p_option;
 
-	// get destination printer
-	num_dests = cupsGetDests (&dests);
-	dest = cupsGetDest (NULL, NULL, num_dests, dests);
-	file_name = cupsGetPPD (dest->name);
-
-	cupsFreeDests (num_dests, dests);
+	// Get PPD file name
+	file_name = getenv("PPD");
+	if (!file_name)
+	  return (1);
 
 	// get options
 	strcpy ( opt->job_name, argv[3]);
@@ -442,10 +437,6 @@
 	}
 	cupsFreeOptions (num_options, p_options);
 
-	// delete temp file
-	unlink (file_name);
-
-
 	return (0);
 }
 
--- fxlinuxprint.h.orig	2021-10-19 10:48:20.897020964 +0200
+++ fxlinuxprint.h	2021-10-19 10:49:08.005324623 +0200
@@ -23,7 +23,7 @@
 //-------- definitions -------------------------
 #define		PDF_FILE_NAME  	"/tmp/tmp_fxpdfXXXXXX"
 
-#define		MAX_STR_SIZE		64
+#define		MAX_STR_SIZE		256
 #define		MAX_FILE_NAME_SIZE	128
 #define		MAX_DECODE_BUF_SIZE	256
 #define		READ_DATA_SIZE		(1024*256)
